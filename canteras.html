function findLocationBlock(rows){
  const isLoc = v => {
    const s = normCell(v);
    return s === 'localizacion' || s === 'ubicacion' || s === 'localizacionobra' || s === 'ubicacionobra';
  };
  const isLat = v => normCell(v) === 'latitud';
  const isLon = v => normCell(v) === 'longitud';

  for(let i=0;i<rows.length;i++){
    const r = rows[i] || [];
    const locPos = r.findIndex(isLoc);
    if(locPos === -1) continue;

    const latPos = r.findIndex(isLat);
    const lonPos = r.findIndex(isLon);

    // Caso 1: fila cabecera: LOCALIZACION | LATITUD | LONGITUD (en cualquier columna)
    if(latPos !== -1 || lonPos !== -1){
      const next = rows[i+1] || [];
      return {
        textValue: next[locPos] ?? '',
        latValue:  (latPos !== -1 ? (next[latPos] ?? '') : ''),
        lonValue:  (lonPos !== -1 ? (next[lonPos] ?? '') : ''),
        cutIndex: i
      };
    }

    // Caso 2: fila directa: LOCALIZACION | <texto> | <lat> | <lon>
    return {
      textValue: r[locPos+1] ?? '',
      latValue:  r[locPos+2] ?? '',
      lonValue:  r[locPos+3] ?? '',
      cutIndex: i
    };
  }
  return null;
}
